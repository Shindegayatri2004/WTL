<!DOCTYPE html>
<html>
<head>
  <title>Simple CRUD</title>
</head>
<body>
  <h2>Student CRUD</h2>

  ID: <input id="id" type="number" placeholder="ID"> 
  Name: <input id="username" placeholder="Name"> 
  Marks: <input id="marks" type="number" placeholder="Marks">

  <br><br>
  <button onclick="insert()">Insert</button>
  <button onclick="update()">Update</button>
  <button onclick="del()">Delete</button>
  <button onclick="display()">Display</button>

  <h3>Records</h3>
  <div id="out"></div>

  <script>
    async function insert() {
      let f = new FormData();
      f.append("username", username.value);
      f.append("marks", marks.value);
      let r = await fetch("insert.php",{method:"POST",body:f});
      alert(await r.text()); display();
    }

    async function update() {
      let f = new FormData();
      f.append("id", id.value);
      f.append("username", username.value);
      f.append("marks", marks.value);
      let r = await fetch("update.php",{method:"POST",body:f});
      alert(await r.text()); display();
    }

    async function del() {
      let f = new FormData();
      f.append("id", id.value);
      let r = await fetch("delete.php",{method:"POST",body:f});
      alert(await r.text()); display();
    }

    async function display() {
      let r = await fetch("display.php");
      out.innerHTML = await r.text();
    }

    window.onload = display;
  </script>
</body>
</html>










<?php
$conn = new mysqli("localhost","root","","bt2");
$name = $_POST['username'];
$marks = $_POST['marks'];
$q = "INSERT INTO student(username,marks) VALUES('$name',$marks)";
echo $conn->query($q) ? "Inserted" : "Error";
$conn->close();
?>

<?php
$conn = new mysqli("localhost","root","","bt2");
$id = $_POST['id'];
$name = $_POST['username'];
$marks = $_POST['marks'];
$q = "UPDATE student SET username='$name', marks=$marks WHERE id=$id";
echo $conn->query($q) ? "Updated" : "Error";
$conn->close();
?>

<?php
$conn = new mysqli("localhost","root","","bt2");
$id = $_POST['id'];
$q = "DELETE FROM student WHERE id=$id";
echo $conn->query($q) ? "Deleted" : "Error";
$conn->close();
?>

<?php
$conn = new mysqli("localhost","root","","bt2");
$r = $conn->query("SELECT * FROM student");
if($r->num_rows>0){
  echo "<table border=1><tr><th>ID</th><th>Name</th><th>Marks</th></tr>";
  while($row=$r->fetch_assoc()){
    echo "<tr><td>{$row['id']}</td><td>{$row['username']}</td><td>{$row['marks']}</td></tr>";
  }
  echo "</table>";
} else echo "No records";
$conn->close();
?>
